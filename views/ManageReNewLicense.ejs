<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>จัดการการเดินทะเบียน</title>
    <link rel="shortcut icon" type="image/png" href="http://www.bhwelder.com.my/img/hotproduct.png" />
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

</head>

<body class="app sidebar-mini rtl">
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" href="/dashboard">Choktwee</a>
        <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar"
            aria-label="Hide Sidebar"></a>
        <!-- Navbar Right Menu-->
        <ul class="app-nav">


            <!-- User Menu-->
            <li class="dropdown"><a class="app-nav__item" href="#" data-toggle="dropdown"
                    aria-label="Open Profile Menu"><i class="fa fa-user fa-lg"></i></a>
                <ul class="dropdown-menu settings-menu dropdown-menu-right">
                    <li><a class="dropdown-item" href="#"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
                    <li><a class="dropdown-item" href="#"><i class="fa fa-user fa-lg"></i> Profile</a></li>
                    <li><a class="dropdown-item" href="login"><i class="fa fa-sign-out fa-lg"></i> Logout</a>
                    </li>
                </ul>
            </li>
        </ul>
    </header>
    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar">
        <div class="app-sidebar__user"><p class="app-sidebar__user-name" id="profilename">ภัทรดนัย ช่างเหลา</p>
        </div>
        <ul class="app-menu">
                <li><a class="app-menu__item" href="/dashboard"><i class="app-menu__icon fa fa-dashboard"></i><span
                            class="app-menu__label">แดชบอร์ด</span></a></li>
                <li class="treeview"><a class="app-menu__item" href="#" data-toggle="treeview"><i
                            class="app-menu__icon fa fa-car"></i><span class="app-menu__label">จัดการสต็อครถ</span><i
                            class="treeview-indicator fa fa-angle-right"></i></a>
                    <ul class="treeview-menu">
                        <li><a class="treeview-item" href="/mangecar"><i class="icon fa fa-circle-o"></i>
                                สต็อครถ</a></li>
                        <li><a class="treeview-item" href="/buycar" rel="noopener"><i class="icon fa fa-circle-o"></i>
                                ซื้อรถเข้า</a></li>
                        <li><a class="treeview-item" href="/sellcar"><i class="icon fa fa-circle-o"></i>จัดการขายรถ</a></li>
                    </ul>
                </li>
                <li><a class="app-menu__item" href="/manage-repair"><i class="app-menu__icon fa fa-dashboard"></i><span
                            class="app-menu__label">จัดการซ่อม</span></a></li>
                <li><a class="app-menu__item active" href="/renewlicense"><i class="app-menu__icon fa fa-cogs"></i><span
                            class="app-menu__label">จัดการเดินทะเบียน</span></a></li>
                <li><a class="app-menu__item" href="/customer"><i class="app-menu__icon fa fa-user-circle-o"></i><span
                            class="app-menu__label">ดูข้อมูลลูกค้า</span></a></li>
                <!-- <li><a class="app-menu__item" href="/report"><i class="app-menu__icon fa fa-pie-chart"></i><span
                            class="app-menu__label">ดูรายงาน</span></a></li> -->
                <li><a class="app-menu__item" href="/mangeemployee"><i class="app-menu__icon fa fa-cogs"></i><span
                            class="app-menu__label">จัดการพนักงาน</span></a></li>
            </ul>
    </aside>
    <main class="app-content">
        <div class="app-title">
            <div>
                <h1><i class="fa fa-th-list"></i> จัดการการเดินทะเบียน</h1>
                <p>เพิ่ม ลบ แก้ไข การเดินทะเบียน</p>
            </div>
            <ul class="app-breadcrumb breadcrumb side">
                <li class="breadcrumb-item"><i class="fa fa-home fa-lg"></i></li>
                <li class="breadcrumb-item active"><a href="/renewlicense">จัดการการเดินทะเบียน</a></li>

            </ul>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="tile">
                    <div class="tile-body">
                        <button type="button" class="btn btn-outline-success btn-block"
                            style="font-size: 15px; width: 5%; float: right;" data-toggle="modal" data-toggle="modal"
                            data-target=".AddModalCenter">เพิ่ม</button>
                        <table class="table table-hover table-bordered" id="sampleTable">
                            <thead>
                                <tr align="center">
                                    <th>รหัสการเดินทะเบียน</th>
                                    <th>วันที่</th>
                                    <th>เลขทะเบียน</th>
                                    <!--
                                     <th>จำนวน</th>
                                -->
                                    <th>ราคา</th>
                                    <th>หมายเลขบัตรประชาชนลูกค้า</th>
                                    <th>รหัสพนักงาน</th>
                                    <th style="width: 138.8px">แก้ไข</th>
                                    <th style="width: 141px">ลบ</th>
                                    <th style="width: 130px">ออกใบเสร็จ</th>
                                    <th style="width: 122px">ออกใบกำกับภาษี</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% for(var i= 0; i < license.length; i++) { %>
                                <tr>
                                    <td>
                                        <%= license[i].ID_TRN_renew_license %>
                                    </td>
                                    <td>
                                        <%= license[i].renew_license_date %>
                                    </td>
                                    <td>
                                        <%= license[i].car_license %>
                                    </td>
                                    <!--
<td>
                                        <%= license[i].renew_license_count %>
                                    </td>
                                    -->
                                    <td>
                                        <%= license[i].renew_license_price %>
                                    </td>
                                    <td>
                                        <%= license[i].customer_citizen_id %>
                                    </td>
                                    <td>
                                        <%= license[i].ID_MST_employeeId %>
                                    </td>

                                    <td>
                                        <button type="button" class="btn btn-outline-warning btn-block"
                                            style="font-size: 15px;" data-toggle="modal" data-toggle="modal"
                                            data-target=".editModal"
                                            onclick="feedLicense('<%= license[i]._id %>','<%= license[i].ID_TRN_renew_license %>','<%= license[i].renew_license_date %>','<%=license[i].renew_license_count%>','<%=license[i].renew_license_price%>','<%=license[i].car_license%>','<%=license[i].ID_MST_employeeId%>','<%=license[i].ID_TRN_bill%>','<%=license[i].ID_MST_customer%>')">แก้ไข</button>
                                    </td>
                                    <td>
                                        <a class="btn btn-outline-danger btn-block"
                                            href="/renewlicense/delete/<%= license[i]._id %>">ลบ</a>
                                    </td>
                                    <td>
                                        <a class="btn btn-outline-primary  btn-block"
                                            href="/renewlicense/bill/<%= license[i]._id%>">
                                            ออกใบเสร็จ
                                        </a>
                                    </td>
                                    <td>
                                        <a class="btn btn-outline-primary btn-block"
                                            href="/renewlicense/bill2/<%=license[i]._id%>">
                                            ออกใบกำกับภาษี
                                        </a>
                                    </td>

                                </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal  แก้ไข -->
        <div class="modal fade editModal" tabindex="-1" role="dialog" aria-labelledby="editModal" aria-hidden="true">
            <div class="modal-dialog modal-xl" role="document">
                <form action="renewlicense/update" method="post">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editModal">
                                แก้ไขรายการเดินทะเบียน</h5>
                            <!--
                               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                           -->
                        </div>
                        <div class="modal-body">
                            <h5>
                                ข้อมูลการเดินทะเบียน
                            </h5>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"
                                        id="inputGroup-sizing-default">รหัสการเดินทะเบียน</span>
                                </div>
                                <input type="text" name="_id" id="editid" style="display: none">
                                <input type="text" name="ID_TRN_renew_license" id="edit_ID_TRN_renew_license"
                                    class="form-control" aria-label="Sizing example input">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="inputGroup-sizing-default">วันที่</span>
                                </div>
                                <input type="text" name="renew_license_date" id="edit_renew_license_date"
                                    class="form-control" aria-label="Sizing example input">
                            </div>


                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="inputGroup-sizing-default">รหัสพนักงาน</span>
                                </div>
                                <input type="text" name="ID_MST_employeeId" id="edit_ID_MST_employeeId"
                                    class="form-control" aria-label="Sizing example input">
                            </div>

                            <!--
                             <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="inputGroup-sizing-default">จำนวน</span>
                                </div>
                                <input type="text" name="renew_license_count" id="edit_renew_license_count"
                                    class="form-control" aria-label="Sizing example input">
                            </div>
                        -->

                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="inputGroup-sizing-default">ราคา</span>
                                </div>
                                <input type="text" name="renew_license_price" id="edit_renew_license_price"
                                    class="form-control" aria-label="Sizing example input">
                            </div>

                            <!--
                                <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="inputGroup-sizing-default">รหัสบิล</span>
                                </div>
                                <input type="text" name="ID_TRN_bill" id="edit_ID_TRN_bill" class="form-control"
                                    aria-label="Sizing example input">
                            </div>
                          -->

                            <hr>

                            <h5 style="float: left">รายการทะเบียน </h5>
                            <span style="float: right ; ">
                                <!--
 <button type="button" onclick="addList()" class="btn btn-primary">เพิ่มรายการ</button>
                               -->
                                <br>
                                <p></p>
                            </span>

                            <div class="input-group mb-3" id="list">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="inputGroup-sizing-default">เลขทะเบียนรถ</span>
                                </div>
                                <input type="text" name="car_license" id="edit_car_license" class="form-control"
                                    aria-label="Sizing example input">
                            </div>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                                <button type="submit" class="btn btn-primary">ยืนยัน</button>
                            </div>


                </form>
            </div>
        </div>
    </main>



    <!-- Modal เพิ่ม -->
    <div class="modal fade AddModalCenter" tabindex="-1" role="dialog" aria-labelledby="AddModalCenter"
        aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <form action="renewlicense/insert" method="post">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="AddModalCenter">
                            เพิ่มรายการเดินทะเบียน</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <h5>รายละเอียดลูกค้า</h5>

                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text"
                                    id="inputGroup-sizing-default">เลขประจำตัวประชาชนลูกค้า</span>
                            </div>
                            <input required maxlength="13" type="text" name="customer_citizen_id"
                                id="customer_citizen_id" class="form-control" aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">ชื่อ</span>
                            </div>
                            <input required type="text" name="customer_first_name" id="customer_first_name"
                                class="form-control" aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">นามสกุล</span>
                            </div>
                            <input required type="text" name="customer_last_name" id="customer_last_name"
                                class="form-control" aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">บ้านเลขที่</span>
                            </div>
                            <input required type="text" name="address_id" id="address_id" class="form-control"
                                aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">หมู่</span>
                            </div>
                            <input required type="text" name="bloc" id="bloc" class="form-control"
                                aria-label="Sizing example input">
                        </div>



                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">อำเภอ</span>
                            </div>
                            <input required type="text" name="district" id="district" class="form-control"
                                aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">ตำบล</span>
                            </div>
                            <input required type="text" name="sub_district" id="sub_district" class="form-control"
                                aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">จังหวัด</span>
                            </div>
                            <input required type="text" name="province" id="province" class="form-control"
                                aria-label="Sizing example input">
                        </div>



                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">รหัสไปรษณีย์</span>
                            </div>
                            <input required type="text" name="postcode" id="postcode" class="form-control"
                                aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">อีเมล</span>
                            </div>
                            <input required type="email" name="customer_email" id="customer_email" class="form-control"
                                aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">ประเภท</span>
                            </div>
                            <input required readonly type="email" name="customer_type" id="customer_type"
                                class="form-control" aria-label="Sizing example input" value="ต่อทะเบียน">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">เบอร์โทรศัพท์</span>
                            </div>
                            <input required type="text" name="customer_telephone" id="customer_telephone"
                                class="form-control" aria-label="Sizing example input">
                        </div>



                        <hr>
                        <h5>
                            ข้อมูลการเดินทะเบียน
                        </h5>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">รหัสการเดินทะเบียน</span>
                            </div>
                            <input required type="text" name="ID_TRN_renew_license" id="ID_TRN_renew_license"
                                class="form-control" aria-label="Sizing example input">
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">วันที่</span>
                            </div>
                            <input required type="date" name="renew_license_date" id="renew_license_date"
                                class="form-control" aria-label="Sizing example input">
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">รหัสพนักงาน</span>
                            </div>
                            <input required type="text" name="ID_MST_employeeId" id="ID_MST_employeeId"
                                class="form-control" aria-label="Sizing example input">
                        </div>

                        <hr>

                        <h5 style="float: left">รายการทะเบียน </h5>


                        <div class="input-group mb-3" id="list">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-default">เลขทะเบียนรถ</span>
                            </div>
                            <input required type="text" name="car_license" id="car_license" class="form-control"
                                aria-label="Sizing example input">
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                            <button type="submit" class="btn btn-primary">ยืนยัน</button>
                        </div>


            </form>
        </div>
    </div>


    <!-- Essential javascripts for application to work-->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>
    <!-- The javascript plugin to display page loading on top-->
    <script src="js/plugins/pace.min.js"></script>
    <!-- Page specific javascripts-->
    <!-- Data table plugin-->
    <script type="text/javascript" src="js/plugins/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="js/plugins/dataTables.bootstrap.min.js"></script>

    <script>
        $('#sampleTable').DataTable();
        $('#profilename').text("ยินดีต้อนรับคุณ : " + localStorage.getItem("name"));
        //console.log($('#sampleTable').DataTable())
        function feedLicense(_id, ID_TRN_renew_license, renew_license_date, renew_license_count, renew_license_price, car_license, ID_MST_employeeId, ID_TRN_bill, ID_MST_customer) {
            // console.log(_id, ID_TRN_renew_license, renew_license_date, renew_license_count, renew_license_price, car_license, ID_MST_employeeId, ID_TRN_bill, ID_MST_customer)
            editid: $('#editid').val(_id)
            ID_TRN_renew_license: $('#edit_ID_TRN_renew_license').val(ID_TRN_renew_license)
            renew_license_date: $('#edit_renew_license_date').val(renew_license_date)
            ID_MST_employeeId: $('#edit_ID_MST_employeeId').val(ID_MST_employeeId)
            car_license: $('#edit_car_license').val(car_license)
            renew_license_price: $("#edit_renew_license_price").val(renew_license_price)
            ID_TRN_bill: $("#edit_ID_TRN_bill").val(ID_TRN_bill)
            //console.log($('#sampleTable').DataTable())
        }

        function feedBill() {

        }

    </script>

</body>

</html>